---
title: "20191209_OSEAR Prelim Baseline"
author: "Emma"
date: "02/18/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages, include=FALSE}
library(tidyverse)
library(here)
library(ggplot2)
library(knitr)
library(kableExtra)
library(lubridate)
library(tableone)
library(forcats)
library(stringr)
library(janitor)
library(dplyr)
library(qwraps2)
library(plyr)
library(ggridges)
library(viridis)
library(RColorBrewer)
library(cowplot)
library(gridExtra)
library(beeswarm)
library(ggbeeswarm)
library(rlang)
options(qwraps2_markup = "markdown")
```

## Read in the 6mo data
```{r reading_data, results="hide"}

data6 <- read_csv(here::here("Data", "20191212_OSEAR 6mo prelim data.csv"))
codebook6 <- read_csv(here::here("Data", "20191213_OSEAR 6mo prelim codebook.csv"))

colnames(data6) <- colnames(codebook6)

```

## Relabel responses 
```{r relabel}

# Old school mutate way 
data6 <- data6 %>% 
  mutate(1_qol = ifelse(1_qol == 1, "Very poor", 1_qol)) %>% 
  mutate(1_qol = ifelse(1_qol == 2, "Poor", 1_qol)) %>% 
  mutate(1_qol = ifelse(1_qol == 3, "Neither poor nor good", 1_qol)) %>% 
  mutate(1_qol = ifelse(1_qol == 4, "Good", 1_qol)) %>% 
  mutate(1_qol = ifelse(1_qol == 5, "Very good", 1_qol)) %>% 
  mutate(1_sat = ifelse(1_sat == 1, "Very poor", 1_sat)) %>% 
  mutate(1_sat = ifelse(1_sat == 2, "Poor", 1_sat)) %>% 
  mutate(1_sat = ifelse(1_sat == 3, "Neither poor nor good", 1_sat)) %>% 
  mutate(1_sat = ifelse(1_sat == 4, "Good", 1_sat)) %>% 
  mutate(1_sat = ifelse(1_sat == 5, "Very good", 1_sat)) 

# similar case_when method
data6 <- data6 %>% 
  mutate(pain = case_when(is.na(pain) ~ "missing", 
                              pain == 1 ~ "Not at all", 
                              pain == 2 ~ "A little", 
                              pain == 3 ~ "A moderate amount", 
                              pain == 4 ~ "Very much", 
                              pain == 5 ~ "An extreme amount", 
                              TRUE ~ "other")) %>% 
  mutate(med = case_when(is.na(med) ~ "missing", 
                              med == 1 ~ "Not at all", 
                              med == 2 ~ "A little", 
                              med == 3 ~ "A moderate amount", 
                              med == 4 ~ "Very much", 
                              med == 5 ~ "An extreme amount", 
                              TRUE ~ "other")) %>% 
  mutate(enjoy = case_when(is.na(enjoy) ~ "missing", 
                              enjoy == 1 ~ "Not at all", 
                              enjoy == 2 ~ "A little", 
                              enjoy == 3 ~ "A moderate amount", 
                              enjoy == 4 ~ "Very much", 
                              enjoy == 5 ~ "An extreme amount", 
                              TRUE ~ "other"))
  mutate(mean = case_when(is.na(mean) ~ "missing", 
                              mean == 1 ~ "Not at all", 
                              mean == 2 ~ "A little", 
                              mean == 3 ~ "A moderate amount", 
                              mean == 4 ~ "Very much", 
                              mean == 5 ~ "An extreme amount", 
                              TRUE ~ "other"))

# Trying a piped for-loop 
for(var in c('pain', 'med', 'enjoy', 'mean', 'concent', 'safe')) {
    data <- data6 %>% 
      mutate(!!var := case_when(is.na(get(var)) ~ "Missing", 
                                  get(var) == 1 ~ "Not at all", 
                                  get(var) == 2 ~ "A little", 
                                  get(var) == 3 ~ "A moderate amount", 
                                  get(var) == 4 ~ "Very much", 
                                  get(var) == 5 ~ "An extreme amount", 
                                  TRUE ~ "other"))
  }
  

for (var in c('pain', 'med', 'enjoy')) {
  data <- data6 %>% 
    mutate(!!var := ifelse(is.na(get(var)) == TRUE, "missing", get(var))) %>%
    mutate(!!var := ifelse(get(var) == 1, "Not at all", get(var))) %>% 
    mutate(!!var := ifelse(get(var) == 5, "An extreme amount", get(var)))
  
}
  
  
# Trying a base R for-loop 

y <- data6[,7:18]

data2 <- switch(
  y, 
  1 = "Not at all", 
  2 = "A little", 
  3 = "A moderate amount", 
  4 = "Very much", 
  5 = "An extreme amount"
)

# huhhhhh 

for(var in c("pain", "med", "enjoy")) {
  data3 <- data6 %>% 
    apply_labels(get(var), 
                 !!var := c("Not at all" = 1, 
                           "A little" = 2, 
                           "A moderate amount" = 3, 
                           "Very much" = 4, 
                           "An extreme amount" = 5)
                 )
}

data3 <- apply_labels(data6, 
                      )


```

# Work-around: assign labels after taking counts
```{r tabs}



```








